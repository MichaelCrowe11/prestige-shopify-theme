{% comment %}
  Social Media Meta Tags
  Open Graph and Twitter Card implementation
{% endcomment %}

{%- liquid
  assign og_title = page_title | default: shop.name
  assign og_description = page_description | default: shop.description | default: shop.name
  assign og_url = canonical_url | default: shop.url
  assign og_type = 'website'
  assign twitter_card = 'summary_large_image'

  if request.page_type == 'product'
    assign og_type = 'product'
    assign og_image = product.featured_image | image_url: width: 1200
    assign twitter_label1 = 'Price'
    assign twitter_data1 = product.price | money
    assign twitter_label2 = 'Availability'
    if product.available
      assign twitter_data2 = 'In stock'
    else
      assign twitter_data2 = 'Out of stock'
    endif
  elsif request.page_type == 'collection'
    assign og_image = collection.image | default: collection.products.first.featured_image | image_url: width: 1200
  elsif request.page_type == 'article'
    assign og_type = 'article'
    assign og_image = article.image | image_url: width: 1200
    assign article_author = article.author | default: shop.name
    assign article_published_time = article.published_at | date: '%Y-%m-%d'
  elsif request.page_type == 'page'
    assign og_image = page.image | image_url: width: 1200
  else
    assign og_image = settings.og_image | default: settings.logo | image_url: width: 1200
  endif

  unless og_image
    assign og_image = settings.og_image | default: settings.logo | image_url: width: 1200
  endunless
-%}

<!-- Open Graph meta tags -->
<meta property="og:type" content="{{ og_type }}">
<meta property="og:title" content="{{ og_title | escape }}">
<meta property="og:description" content="{{ og_description | escape | truncate: 160 }}">
<meta property="og:url" content="{{ og_url }}">
<meta property="og:site_name" content="{{ shop.name | escape }}">
<meta property="og:locale" content="{{ request.locale.iso_code }}">

{%- if og_image -%}
  <meta property="og:image" content="https:{{ og_image }}">
  <meta property="og:image:secure_url" content="https:{{ og_image }}">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:image:alt" content="{{ og_title | escape }}">
{%- endif -%}

{%- if request.page_type == 'product' -%}
  <meta property="og:price:amount" content="{{ product.price | money_without_currency | strip_html }}">
  <meta property="og:price:currency" content="{{ shop.currency }}">

  {%- if product.available -%}
    <meta property="og:availability" content="instock">
  {%- else -%}
    <meta property="og:availability" content="outofstock">
  {%- endif -%}

  {%- if product.vendor -%}
    <meta property="product:brand" content="{{ product.vendor | escape }}">
  {%- endif -%}
{%- endif -%}

{%- if request.page_type == 'article' -%}
  <meta property="article:author" content="{{ article_author | escape }}">
  <meta property="article:published_time" content="{{ article_published_time }}">
  <meta property="article:modified_time" content="{{ article.updated_at | date: '%Y-%m-%d' }}">
  <meta property="article:section" content="{{ blog.title | escape }}">

  {%- for tag in article.tags -%}
    <meta property="article:tag" content="{{ tag | escape }}">
  {%- endfor -%}
{%- endif -%}

<!-- Twitter Card meta tags -->
<meta name="twitter:card" content="{{ twitter_card }}">
<meta name="twitter:title" content="{{ og_title | escape | truncate: 70 }}">
<meta name="twitter:description" content="{{ og_description | escape | truncate: 200 }}">

{%- if og_image -%}
  <meta name="twitter:image" content="https:{{ og_image }}">
  <meta name="twitter:image:alt" content="{{ og_title | escape }}">
{%- endif -%}

{%- if settings.social_twitter_link != blank -%}
  <meta name="twitter:site" content="@{{ settings.social_twitter_link | split: 'twitter.com/' | last | remove: '@' }}">
  <meta name="twitter:creator" content="@{{ settings.social_twitter_link | split: 'twitter.com/' | last | remove: '@' }}">
{%- endif -%}

{%- if request.page_type == 'product' -%}
  <meta name="twitter:label1" content="{{ twitter_label1 }}">
  <meta name="twitter:data1" content="{{ twitter_data1 }}">
  <meta name="twitter:label2" content="{{ twitter_label2 }}">
  <meta name="twitter:data2" content="{{ twitter_data2 }}">
{%- endif -%}

<!-- Pinterest verification -->
{%- if settings.pinterest_verification != blank -%}
  <meta name="p:domain_verify" content="{{ settings.pinterest_verification }}">
{%- endif -%}

<!-- Facebook domain verification -->
{%- if settings.facebook_domain_verification != blank -%}
  <meta name="facebook-domain-verification" content="{{ settings.facebook_domain_verification }}">
{%- endif -%}